language: python
sudo: true
matrix:
  include:
    - os: linux
      sudo: required
      python: 3.6
      env: TOXENV=py36
    - os: osx
      language: generic
      env: TOXENV=py36
before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
      brew update;
      brew install pyenv;
      echo 'eval "$(pyenv init -)"' >> ~/.bash_profile;
      source ~/.bash_profile;
      pyenv install 3.6.0;
      pyenv global 3.6.0;
      brew install libtool automake geth pkg-config;
      brew install openssl;
      cd /usr/local/include;
      ln -s ../opt/openssl/include/openssl;
      cd $TRAVIS_BUILD_DIR;
    fi
  - pip install --upgrade pip
install:
  - sh prepare.sh
  - pip install -r requirements.txt
  - pip install --upgrade setuptools
# - pip list --outdated --format=legacy | awk '{print $1}' | sudo -H xargs pip install -U
script:
  - cd tests
  - for f in test_*.py; do pytest ${f}; done;
